# ED-Multi SNN プロジェクト概要

## プロジェクト目的

金子勇氏（1999）の革新的なError-Diffusion（ED）法をスパイキングニューラルネットワーク（SNN）に適用し、生物学的に妥当な学習アルゴリズムによる画像分類システムを構築する。

## 核心技術

### 1. ED法（Error-Diffusion法）
- **開発者**: 金子勇氏（1999年）
- **特徴**: 「微分の連鎖律を用いた誤差逆伝播法」を使用しない
- **生物学的妥当性**: 実際の脳の学習メカニズムに近い
- **アミン拡散**: 神経伝達物質の拡散による誤差信号伝播

### 2. スパイキングニューラルネットワーク（SNN）
- **全層LIF化**: 1706個の全ニューロンがLeaky Integrate-and-Fire（LIF）モデル
- **スパイク符号化**: ポアソン符号化（150Hz, 50ms）
- **時間的ダイナミクス**: 膜電位の時間的統合とスパイク発火

### 3. 生物学的制約の遵守
- **E/Iペア構造**: 興奮性・抑制性ニューロンペア
- **Dale's Principle**: 興奮性重み≥0、抑制性重み≤0
- **独立出力ニューロン**: クラスごとに独立したネットワーク

## 達成成果

### 精度実績
- **MNIST**: テスト正答率85.0%（訓練正答率85.9%）
- **Fashion-MNIST**: テスト正答率82.0%
- **汎化ギャップ**: 0.9%（過学習なし）

### 技術的優位性
1. **並列計算可能**: 各層が独立して重み更新
2. **勾配消失問題回避**: 連鎖律を使用しない局所学習
3. **生物学的妥当性**: 実際の脳の学習原理に基づく
4. **エネルギー効率**: スパイクベースの計算

## 実装バリエーション

### 1. 完全LIF版（ed_multi_lif_snn.py）
- 全ニューロンがLIF型
- 最も生物学的に妥当
- 研究用途に最適

### 2. シンプル版（ed_multi_lif_snn_simple.py）
- コード理解しやすい基本実装
- 学習・教育用途
- アルゴリズム理解に最適

### 3. FReLU版（ed_multi_frelu_snn.py）
- FReLU活性化関数の実験実装
- ハイブリッド構成
- 新しい活性化関数の検証

## 拡張機能

### 元理論からの拡張
1. **多層ネットワーク対応**: 任意の隠れ層構造
2. **ミニバッチ学習**: 効率的なバッチ処理
3. **NumPy行列演算**: 1,899倍の高速化
4. **動的メモリ管理**: データ量に応じた自動調整
5. **リアルタイム可視化**: 学習進捗の動的表示

### 現代的な統合
6. **モダンデータローダー**: TensorFlow統合
7. **GPU計算対応**: CuPy統合による自動GPU計算
8. **詳細プロファイリング**: 性能ボトルネック特定
9. **ヒートマップ可視化**: ニューロン発火パターン表示

### SNN特有の機能
10. **複数スパイク符号化**: Poisson/Rate/Temporal/Population
11. **LIFニューロン統合**: 生物学的に妥当なスパイク生成
12. **スパイク-ED変換**: スパイク活動とED法入力の双方向変換
13. **高速SNN実装**: 大規模SNN計算の最適化

## 研究的意義

### 神経科学への貢献
- 生物学的妥当性の高い学習アルゴリズム
- スパイクベース計算の実用化
- 脳の学習メカニズムの理解促進

### 工学的価値
- エッジデバイス向けの省エネルギー学習
- 並列処理による高速化
- 勾配消失問題の根本的解決

### 将来展望
- ニューロモーフィックハードウェアへの応用
- 大規模スパイキングネットワークの実現
- 生物学的知能の工学的実装

## 技術仕様

### システム要件
- Python 3.7+
- NumPy, TensorFlow, matplotlib
- オプション: CuPy（GPU加速）

### パフォーマンス
- MNIST 1000サンプル×10エポック: 約21分（CPU）
- メモリ使用量: 16GB RAM内で自動調整
- GPU加速: 透明な切り替え

### 対応データセット
- MNIST（手書き数字）
- Fashion-MNIST（衣類分類）
- CIFAR-10/100（カラー画像）

## プロジェクト構造

```
ed_multi_snn/
├── src/
│   ├── ja/                    # 日本語コメント版
│   └── en/                    # 英語コメント版
├── docs/
│   ├── ja/                    # 日本語ドキュメント
│   └── en/                    # 英語ドキュメント
├── modules/                   # 共通モジュール群
├── test_results/              # 学習結果記録
└── viz_results/               # 可視化結果
```

## 関連文献・資料

### 技術仕様
- [ed_multi_snn.prompt.md](ed_multi_snn.prompt.md) - 完全技術仕様書

### 理論背景
- [ED法_解説資料.md](ED法_解説資料.md) - ED法の詳細解説
- [EDLA_金子勇氏.md](EDLA_金子勇氏.md) - 金子勇氏の原論文資料

### 実験結果
- [test_results/](../../test_results/) - 学習試行記録
- [viz_results/](../../viz_results/) - 可視化結果

---

**このプロジェクトは、生物学的知能の原理を工学的に実装し、次世代AIの基盤技術を提供することを目指しています。**